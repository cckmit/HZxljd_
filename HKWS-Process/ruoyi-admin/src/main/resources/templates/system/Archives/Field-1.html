<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>数智闲林·统一门户管理平台</title>
    <link th:href = "@{/layui/css/layui.css}" rel = "stylesheet" />
    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet"/>
    <link th:href="@{/icon/iconfont.css}" rel="stylesheet"/>
    <link th:href="@{/css/public.css}" rel="stylesheet"/>
    <link th:href="@{/css/Thing.css}" rel="stylesheet"/>

    <script>
        //rem布局动态更改html
        (function (win) {
            var tid;

            function refreshRem() {
                let designSize = 1920;
                let html = document.documentElement;
                let wW = html.clientWidth;
                let rem = (wW * 100) / designSize;
                document.documentElement.style.fontSize = rem + "px";
            }

            win.addEventListener(
                "resize",
                function () {
                    clearTimeout(tid);
                    tid = setTimeout(refreshRem, 100);
                },
                false
            );
            win.addEventListener(
                "pageshow",
                function (e) {
                    if (e.persisted) {
                        clearTimeout(tid);
                        tid = setTimeout(refreshRem, 100);
                    }
                },
                false
            );

            refreshRem();
        })(window);
    </script>
</head>
<body>
<div class = "mediaCont">
<div th:include="common/header :: header"></div>
<div th:include="common/sidebar::sidebar(activeUri='field')"></div>
</div>
<div class = "mediaCont mediaCenter">
<div class = "container-fluid nav-stacked Thing-nav">
    <div class = "thingTab layui-row">
        <ul class = "trend-Tabtile layui-row" id = "dataTab">
            <li class = " active">本日</li>
            <li class = "">本周</li>
            <li class = "">本月</li>
            <li class = "">本年</li>
        </ul>
    </div>
    <div class = "layui-row thing-title">

        <div class = "layui-col-md8">
            <div class = "layui-row" style = "height: 13vh">
                <div class = "layui-col-md3 thing-total">
                    <p>
                        <i class = "iconfont">&#xe604;</i>
                        <span>区域总数</span>
                    </p>
                    <div class = "thing-num">
                        <b>319</b>
                        <p class="Up">+45%同比增长</p>
                    </div>
                </div>
                <div class = "layui-col-md3 thing-total">
                    <p>
                        <i class = "iconfont">&#xe7ca;</i>
                        <span>区域平均件数</span>
                    </p>
                    <div class = "thing-num">
                        <b>57</b>
                        <p class="Down">-25%同比下降</p>
                    </div>
                </div>
                <div class = "layui-col-md3 thing-total">
                    <p>
                        <i class = "iconfont">&#xe621;</i>
                        <span>区域人数</span>
                    </p>
                    <div class = "thing-num">
                        <b>262</b>
                        <p class="Up">+32%同比增长</p>
                    </div>
                </div>
                <div class = "layui-col-md3 thing-total">
                    <p>
                        <i class = "iconfont">&#xe638;</i>
                        <span>区域负荷率</span>
                    </p>
                    <div class = "thing-num">
                        <b>51</b>
                        <p class="Up">+25%同比增长</p>
                    </div>
                </div>
            </div>
            <div class = "layui-row thing-trend">
                <div class = "layui-row" style = "height: 15%">
                    <div class = "layui-col-md6 trend-title">
                        <p>赋能流转</p>
                    </div>
<!--                    <div class = "layui-col-md6 trend-tab">-->
<!--                        <ul class = "layui-row trend-Tabtile" id="funeng">-->
<!--                            <li class = "layui-col-md4 active">-->
<!--                                本日-->
<!--                            </li>-->
<!--                            <li class = "layui-col-md4">本周</li>-->
<!--                            <li class = "layui-col-md4">本月</li>-->
<!--                        </ul>-->
<!--                        <div class = "thing-data">-->
<!--                            <input-->
<!--                                    type = "text"-->
<!--                                    class = "layui-input"-->
<!--                                    id = "test1"-->
<!--                                    readonly-->
<!--                                    placeholder = "请选择日期范围"-->
<!--                            />-->
<!--                            <i class = "iconfont">&#xe616;</i>-->
<!--                        </div>-->
<!--                    </div>-->
                </div>
                <div
                        class = "layui-row"
                        style = "height: 85%"
                >
                    <div
                            class = ""
                            id = "total"
                            style = "width: 100%; height: 100%"
                    ></div>
                </div>
            </div>
        </div>
        <div class = "layui-col-md4" style = "width: 32%;margin-left: 1%;">
            <div class = "layui-row  empowerment" >
                <div class = "layui-row thing-empowerment">
                    <div class = "layui-col-md6 trend-title">
                        <p>区域效率</p>
                    </div>
                    <div class = "layui-col-md6 trend-tab">

                    </div>
                </div>
                <div
                    class = "layui-row"
                    style = "height: 85%"
                >
                    <div
                        class = ""
                        id = "purchase"
                        style = "width: 100%; height: 100%"
                    ></div>

                </div>
            </div>

        </div>
    </div>
    <div class = "layui-row testing">
        <div class = "layui-col-md4 testing-ting">
            <div class = "layui-row thing-empowerment">
                <div class = "layui-col-md6 trend-title">
                    <p>店铺信誉</p>
                </div>
<!--                <div class = "layui-col-md6 trend-tab">-->
<!--                    <ul class = "trend-Tabtile layui-row" id="xinyu">-->
<!--                        <li class = "layui-col-md4 active">本日</li>-->
<!--                        <li class = "layui-col-md4">本周</li>-->
<!--                        <li class = "layui-col-md4">本月</li>-->
<!--                    </ul>-->
<!--                </div>-->
            </div>
            <div
                    class = "layui-row"
                    style = "height: 87%"
            >
                <div
                        class = ""
                        id = "testing"
                        style = "width: 100%; height: 100%"
                ></div>
            </div>
        </div>
        <div class = "layui-col-md4 testing-ting">
            <div class = "layui-row thing-empowerment">
                <div class = "layui-col-md4 trend-title">
                    <p>类型统计</p>
                </div>
<!--                <div class = "layui-col-md8 trend-tab">-->
<!--                    <ul class = "trend-Tabtile layui-row" id="leixing">-->
<!--                        <li class = "layui-col-md4 active">本日</li>-->
<!--                        <li class = "layui-col-md4">本周</li>-->
<!--                        <li class = "layui-col-md4">本月</li>-->
<!--                    </ul>-->
<!--                    <select name = "" id = "">-->
<!--                        <option value = "">请选择社区</option>-->
<!--                    </select>-->
<!--&lt;!&ndash;                    <form class = "layui-form">&ndash;&gt;-->
<!--&lt;!&ndash;                        <select name = "" lay-verify = "">&ndash;&gt;-->
<!--&lt;!&ndash;                            <option value = "">请选择社区</option>&ndash;&gt;-->
<!--&lt;!&ndash;                        </select>&ndash;&gt;-->
<!--&lt;!&ndash;                    </form>&ndash;&gt;-->
<!--                </div>-->
            </div>
            <div
                    class = "layui-row"
                    style = "height: 85%"
            >
                <div
                        class = ""
                        id = "Statistics"
                        style = "width: 100%; height: 100%"
                ></div>
            </div>
        </div>
        <div class = "layui-col-md4 testing-ting">
            <div class = "layui-row thing-empowerment">
                <div class = "layui-col-md8 trend-title">
                    <p>事件分析</p>
                </div>
                <div class = "layui-col-md4 trend-tab">
                    <ul class = "trend-Tabtile layui-row" id="fenxi">
                        <li class = "layui-col-md6 active">流转率</li>
                        <li
                                class = "layui-col-md6"
                                style = "border-right: 1px solid #ccc"
                        >
                            共治率
                        </li>
                    </ul>
                </div>
            </div>
            <div
                    class = "layui-row"
                    style = "height: 85%"
            >
                <div
                        class = ""
                        id = "analysis"
                        style = "width: 100%; height: 100%"
                ></div>

            </div>
        </div>
    </div>
</div>
</div>
</body>

<script th:src = "@{/layui/layui.js}"></script>
<script th:src="@{/js/echarts.min.js}"></script>

<!--tab切换数据-->
<script>

    $('#dataTab li').on('click',function (){
        // 删除li的active
        $('#dataTab li').removeClass('active');
        // 给当前li添加active
        $(this).addClass('active');
        // 判断当前那个li被点击切换echarts数据
        if($('#dataTab li:eq(0)').is('.active')){
            funeng([40, 38, 80, 94, 141, 87, 104, 120, 78, 88, 69, 100, 67,]);
            xiaolv([262, 145, 86,]);
            xinyu([20, 30, 40, 50, 60, 70, 80, 90, 95])
            tongji([35, 12, 13, 16, 24])
        }else if($('#dataTab li:eq(1)').is('.active')){
            funeng([50, 48, 40, 34, 101, 57, 84, 150, 88, 98, 79, 120, 87,])
            xiaolv([272, 145, 80,]);
            xinyu([40, 60, 80, 70, 90, 100, 120, 130, 150])
            tongji([45, 22, 33, 46, 54])
        } else if ($('#dataTab li:eq(2)').is('.active')) {
            funeng([70, 28, 60, 64, 131, 97, 74, 90, 108, 58, 49, 80, 67,])
            xiaolv([282, 165, 90,])
            xinyu([50, 70, 90, 80, 100, 110, 130, 150, 170])
            tongji([55, 42, 53, 76, 64])
        }
    })
    // 事件分析
    $('#fenxi li').on('click',function (){
        // 删除li的active
        $('#fenxi li').removeClass('active');
        // 给当前li添加active
        $(this).addClass('active');
        // 判断当前那个li被点击切换echarts数据
        if($('#fenxi li:eq(0)').is('.active')){
            fenxi([21, 33, 41, 48, 61, 69, 76, 87])
        }else if($('#fenxi li:eq(1)').is('.active')){
            fenxi([45, 22, 33, 46, 54,70,80,90])
        }
    });

    layui.use(["laydate", "element", "form"], function () {
        var laydate = layui.laydate;
        var element = layui.element;
        var form = layui.form;

        $('#strongBase').on('click', function () {
            layer.msg('暂未开放')
        });
        $('#zongzhi').on('click', function () {
            layer.msg('暂未开放')
        });
        $('#zhian').on('click', function () {
            layer.msg('暂未开放')
        })
        $('#quyu').on('click', function () {
            layer.msg('暂未开放')
        })
        $('#sheqing').on('click', function () {
            layer.msg('暂未开放')
        })
        $('#minsheng').on('click', function () {
            layer.msg('暂未开放')
        })
        $('#zhihui').on('click', function () {
            layer.msg('暂未开放')
        })
        $('#pingtai').on('click', function () {
            layer.msg('暂未开放')
        })
        $("#shugan").on('click',function () {
            layer.msg('暂未开放');
        })
        element.on("tab(demo)", function (data) {
            // console.log(this); //当前Tab标题所在的原始DOM元素
            // console.log(data.index); //得到当前Tab的所在下标
            // console.log(data.elem); //得到当前的Tab大容器
            switch (data.index) {
                case 0:
                    console.log(tdata)
                    this.tdata = [20, 30, 40, 50, 60, 70, 80, 90, 95];
                   //  var Opt = JSON.stringify(toption);
                   //  var opt= JSON.parse(Opt)
                   //  console.log(Opt);
                   //  console.log(opt)
                   //  console.log(opt.series[0].data)
                   //  var Data = opt.series[0].data
                   // Data=[40, 30, 70, 50, 60, 30, 80, 20, 45]
                   //  testing.setOption(toption);
                    // opt.series[0].data=[20, 30, 40, 50, 60, 70, 80, 90, 95]
                    break;
                case 1:
                    this.tdata = [40, 30, 70, 50, 60, 30, 80, 120, 145];
                    testing.setOption(toption, true);

                    break;
                case 2:
                    this.tdata = [80, 50, 90, 80, 70, 50, 90, 130, 155];
                    break;
            }
        });

        //执行一个laydate实例
        laydate.render({
            elem: "#test1", //指定元素
            range: true, //范围选择
        });
    });

    xinyu([20, 30, 40, 50, 60, 70, 80, 90, 95]);
    funeng([40,38,80,94,141,87,104,120,78,88,69,100,67,]);
    xiaolv([262,145,86]);
    tongji([35, 12, 13, 16, 24]);
    fenxi([21, 33, 41, 48, 61, 69, 76, 87]);
    // 赋能流转echarts
    function funeng(data) {
        var total = echarts.init(document.getElementById("total"));
        var Toption = {
            tooltip: {
              trigger: "axis",
              axisPointer: {
                type: "line",
              },
                formatter:function (params) {
                  // console.log(params)
                    var str = '<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:#0070cc;"></span>'+params[0].name+'：'+params[0].value;
                    return str ;
                }
            },
            legend: {
                top: "bottom",
                itemWidth: 15,
                itemHeight: 15,
                textStyle: {
                    color: '#555'
                }
            },
            grid: {
                left: "5%",
                top: "5%",
                right: "5%",
                bottom: "10%",
                containLabel: true,
            },
            xAxis: {
                type: "category",
                axisLine: {
                    lineStyle: {
                        color: "#888",
                    },
                },
                axisTick: {
                    show: false,
                },
                axisLabel: {
                    textStyle: {
                        color: "#333",
                    },
                    interval: 0,
                    rotate: 30,
                },
                data: ['青山', '大园', '蒋杨', '鹤亭', '研口', '胜联', '相府', '青南村', '青南村', '庆南村', '庆北村', '泉口村', '雅观村'],
            },
            yAxis: {
                type: "value",
                axisLine: {
                    show: false,
                },
                axisTick: {
                    show: false,
                },
                splitLine: {
                    show: true,
                    lineStyle: {
                        type: "dashed",
                    },
                },
                axisLabel: {
                    textStyle: {
                        color: "#333",
                    },
                },
                // boundaryGap: [0, 0.01],
            },
            color: ["#0070CC", "#B7CFFF"],
            series: [
                {
                    name: "预警事件发生数",
                    type: "line",
                    data:data ,
                    smooth: true,
                    itemStyle: {
                        borderWidth: 2,
                        color: {
                            type: "linear",
                            x: 0,
                            y: 0,
                            x2: 0,
                            y2: 1,
                            colorStops: [
                                {
                                    offset: 0,
                                    color: "rgba(0,112,204,0.5)", // 0% 处的颜色
                                },
                                {
                                    offset: 1,
                                    color: "rgba(0,112,204,0.3)", // 100% 处的颜色
                                },
                            ],
                            global: false, // 缺省为 false
                        },
                    },
                    symbolSize: 0,
                    lineStyle: {
                        width: 2,
                        color: {
                            type: "linear",
                            x: 0,
                            y: 0,
                            x2: 1,
                            y2: 1,
                            colorStops: [
                                {
                                    offset: 0,
                                    color: "rgba(0,112,204)", // 0% 处的颜色
                                },
                                {
                                    offset: 0.5,
                                    color: "rgba(0,112,204)", // 0% 处的颜色
                                },
                                {
                                    offset: 1,
                                    color: "rgba(0,112,204)", // 100% 处的颜色
                                },
                            ],
                            global: true, // 缺省为 false
                        },
                    },
                    areaStyle: [],
                },
            ],
        };
        total.setOption(Toption);
    }

    // 区域效率echarts
    function xiaolv(data) {
        var purchase = echarts.init(document.getElementById("purchase"));
        var Poption = {
            tooltip: {
                trigger: "item",
                formatter: function (params) {
                    // console.log(params);
                    var str = params.marker + params.name+' '+ params.value + '：' +params.percent + '%';
                    return str;
                },
            },
            grid: {
                top: 5,
                left: 5,
                right: 5,
                bottom: 5,
            },
            color: ["#FEC400", "#0070CC", "#2ACA96",],
            series: [
                {
                    name: "流转率",
                    type: "funnel",
                    left: "10%",
                    top: "5%",
                    //x2: 80,
                    bottom: "5%",
                    width: "80%",
                    // height: {totalHeight} - y - y2,
                    // min: 10,
                    // max: 100,
                    minSize: "0%",
                    maxSize: "80%",
                    sort: "ascending",
                    gap: 3,
                    label: {
                        normal: {
                            show: true,
                            position: "inside",
                            formatter: "{d}%",
                        },
                    },
                    labelLine: {
                        length: 10,
                        lineStyle: {
                            width: 1,
                            type: "solid",
                        },
                    },
                    itemStyle: {
                        borderColor: "#fff",
                        borderWidth: 0,
                    },
                    data: [
                        {
                            value: data[0],
                            name: "研判总数"
                        },
                        {
                            value: data[1],
                            name: "正在处理"
                        },
                        {
                            value: data[2],
                            name: "完成总数"
                        },
                    ],
                },
                {
                    name: "流转率",
                    type: "funnel",
                    left: "10%",
                    top: "5%",
                    //x2: 80,
                    bottom: "5%",
                    width: "80%",
                    // min: 10,
                    // max: 100,
                    minSize: "0%",
                    maxSize: "80%",
                    sort: "ascending",
                    gap: 3,
                    label: {
                        normal: {
                            show: true,
                            // itemStyle:{
                            color: "#333",
                            formatter: function (params) {
                                // console.log(params);
                                var str =
                                    params.data.name +
                                    "   " +
                                    params.data.value;
                                return str;
                            },
                            // }
                        },
                    },
                    labelLine: {
                        length: 10,
                        lineStyle: {
                            width: 1,
                            type: "solid",
                            color: "#888",
                        },
                    },
                    itemStyle: {
                        borderColor: "#fff",
                        borderWidth: 0,
                    },
                    data: [
                        {
                            value: data[0],
                            name: "研判总数"
                        },
                        {
                            value: data[1],
                            name: "正在处理"
                        },
                        {
                            value: data[2],
                            name: "完成总数"
                        },
                    ],
                },
            ],
        };
        purchase.setOption(Poption);
    }

    // 店铺信誉echarts
    function xinyu(Tdata){
        var testing = echarts.init(document.getElementById("testing"));
        var toption = {
            tooltip: {
              trigger: "axis",
              axisPointer: {
                // 坐标轴指示器，坐标轴触发有效
                type: "shadow", // 默认为直线，可选为：'line' | 'shadow'
              },
              formatter: function (params) {
                // console.log(params);
                var str = params[0].marker+params[0].name+'：'+params[0].value;
                return str;
              },
            },
            grid: {
                top: "5%",
                left: "3%",
                right: "4%",
                bottom: "5%",
                containLabel: true,
            },
            xAxis: {
                type: "value",
                axisLine: {
                    show: false,
                    lineStyle: {
                        color: "#888",
                    },
                },
                axisTick: {
                    show: false,
                },
                splitLine: {
                    show: true,
                    lineStyle: {
                        type: "dashed",
                    },
                },
            },
            yAxis: {
                type: "category",
                data: [
                    "爱婴室",
                    "樊图",
                    "行易堂",
                    "百鲜果园",
                    "半斗水果",
                    "花鸟工作室",
                    "龙龙粮油店",
                    "元成小菜场",
                    "英树",
                ],
                axisLine: {
                    show: false,
                },
                axisLabel: {
                    color: '#333'
                },
                axisTick: {
                    show: false,
                },
            },
            color: ["#0070CC"],
            series: [
                {
                    name: "信誉率",
                    type: "bar",
                    data: Tdata,
                    barWidth: 15,
                    label: {
                        show: true,
                        position: 'right',
                        color: '#0070cc'
                    }
                },
            ],
        };
        testing.setOption(toption, true);
    }

    // 类型统计echarts
    function tongji(data) {
        var Statistics = echarts.init(document.getElementById("Statistics"));
        var Soption = {
            tooltip: {
                trigger: "item",
                formatter: function (params) {
                    var result = '';
                    result += params.marker + params.data.name + '：' + params.data.value + '(' + params.percent + '%)';
                    return result
                }
            },
            grid: {
                top: "5%",
                left: 5,
                right: 5,
                bottom: "20%",
                containLabel: true,
            },
            legend: {
                // orient: 'or',
                top: "bottom",
                itemWidth: 15,
                itemHeight: 15,
                textStyle: {
                    color: '#555'
                }
            },
            color: ["#217FCD", "#44CCA0", "#F8C721", "#6E7E9B", "#F98A65"],
            series: [
                {
                    name: "类型统计",
                    type: "pie",
                    radius: ["0%", "70%"],
                    avoidLabelOverlap: false,
                    label: {
                        show: true,
                        position: "outside",
                        formatter: "{d}% {b} ",
                    },

                    labelLine: {
                        show: true,
                    },
                    data: [
                        {
                            value: data[0],
                            name: "青山"
                        },
                        {
                            value: data[1],
                            name: "大圆"
                        },
                        {
                            value: data[2],
                            name: "蒋杨"
                        },
                        {
                            value: data[3],
                            name: "鹤亭"
                        },
                        {
                            value: data[4],
                            name: "硏口"
                        },
                    ],
                },
            ],
        };
        Statistics.setOption(Soption);
    }


    // 事件分析echarts
    function fenxi(data) {
        var analysis = echarts.init(document.getElementById("analysis"));
        var Aoption = {
            tooltip: {
                trigger: "axis",
                axisPointer: {
                    // 坐标轴指示器，坐标轴触发有效
                    type: "shadow", // 默认为直线，可选为：'line' | 'shadow'
                },
                formatter: function (params) {
                    // console.log(params)
                    var str = params[0].marker + params[0].name+'：' + params[0].value;
                    return str
                }
            },
            grid: {
                top: "5%",
                left: "5%",
                right: "5%",
                bottom: "3%",
                containLabel: true,
            },
            xAxis: [
                {
                    type: "value",

                    axisTick: {
                        show: false,
                    },
                    axisLine: {
                        show: false,
                    },
                    axisLabel: {
                        show: false,
                    },
                    splitLine: {
                        show: false,
                    },
                    nameGap: 20,
                    boundaryGap: false,
                },
            ],
            yAxis: [
                {
                    type: "category",
                    axisTick: {
                        show: false,
                    },
                    axisLine: {
                        show: false,
                    },
                    data: ['青山', '大园', '蒋杨', '鹤亭', '研口', '胜联', '相府', '青南村'],
                    axisLabel: {
                        color: '#333'
                    }
                },
            ],

            series: [
                {
                    name: "流转率",
                    type: "bar",
                    barWidth: "60%",
                    stack: "1",
                    data:data ,
                    barWidth: 10,
                    label: {
                        show: true,
                        position: "right",
                    },
                    itemStyle: {
                        barBorderRadius: 15,
                        color: function (params) {
                            var colorList = [
                                "#FFEF8E",
                                "#FECD27",
                                "#C4CCE7",
                                "#7484A0",
                                "#A0F4CA",
                                "#4AD2A6",
                                "#97DDFF",
                                "#2785D3",
                            ];
                            return colorList[params.dataIndex];
                        },
                    },
                },
            ],
        };
        analysis.setOption(Aoption);
    }


    setTimeout(() => {
        var testing = echarts.init(document.getElementById("testing"));
        var analysis = echarts.init(document.getElementById("analysis"));
        var Statistics = echarts.init(document.getElementById("Statistics"));
        var total = echarts.init(document.getElementById("total"));
        var purchase = echarts.init(document.getElementById("purchase"));
        window.onresize = function () {
            purchase.resize();
            testing.resize();
            Statistics.resize();
            total.resize();
            analysis.resize();
        };
    }, 500);
</script>

</html>
