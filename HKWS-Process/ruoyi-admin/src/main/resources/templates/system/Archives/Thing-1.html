<!DOCTYPE html>
<html lang = "zh" xmlns:th = "http://www.thymeleaf.org" xmlns:shiro = "http://www.pollix.at/thymeleaf/shiro">
<head>
    <meta charset = "UTF-8" />
    <meta name = "viewport" content = "width=device-width, initial-scale=1.0" />
    <title>数智闲林·统一门户管理平台</title>
    <link th:href = "@{/layui/css/layui.css}" rel = "stylesheet" />
    <link th:href = "@{/css/bootstrap.min.css}" rel = "stylesheet" />
    <link th:href = "@{/icon/iconfont.css}" rel = "stylesheet" />
    <link th:href = "@{/css/public.css}" rel = "stylesheet" />
    <link th:href = "@{/css/Thing.css}" rel = "stylesheet" />

    <script>
        //rem布局动态更改html
        (function (win) {
            var tid;

            function refreshRem() {
                let designSize = 1920;
                let html = document.documentElement;
                let wW = html.clientWidth;
                let rem = (wW * 100) / designSize;
                document.documentElement.style.fontSize = rem + "px";
            }

            win.addEventListener(
                "resize",
                function () {
                    clearTimeout(tid);
                    tid = setTimeout(refreshRem, 100);
                },
                false
            );
            win.addEventListener(
                "pageshow",
                function (e) {
                    if (e.persisted) {
                        clearTimeout(tid);
                        tid = setTimeout(refreshRem, 100);
                    }
                },
                false
            );

            refreshRem();
        })(window);
    </script>
</head>
<body>
<div class = "mediaCont">
<div th:insert="common/header :: header"></div>
<div th:include="common/sidebar::sidebar(activeUri='thing')"></div>
</div>
<div class = "mediaCont mediaCenter">
<div class = "container-fluid nav-stacked Thing-nav">
    <div class = "thingTab layui-row">
        <ul class = "trend-Tabtile layui-row" id = "dataTab">
            <li class = " active">本日</li>
            <li class = "">本周</li>
            <li class = "">本月</li>
            <li class = "">本年</li>
        </ul>
    </div>
    <div class = "layui-row thing-title">

        <div class = "layui-col-md8">
            <div class = "layui-row" style = "height: 13vh">
                <div class = "layui-col-md3 thing-total">
                    <p>
                        <i class="iconfont">&#xe6ad;</i>
                        <span>事件总数</span>
                    </p>
                    <div class = "thing-num">
                        <b>319</b>
                        <p class="Up">+45%同比增长</p>
                    </div>
                </div>
                <div class = "layui-col-md3 thing-total">
                    <p>
                        <i class = "iconfont">&#xe601;</i>
                        <span>完成总数</span>
                    </p>
                    <div class = "thing-num">
                        <b>67</b>
                        <p class="Down">-25%同比下降</p>
                    </div>
                </div>
                <div class = "layui-col-md3 thing-total">
                    <p>
                        <i class = "iconfont">&#xe600;</i>
                        <span>流转率</span>
                    </p>
                    <div class = "thing-num">
                        <b>62</b>
                        <p class="Up">+32%同比增长</p>
                    </div>
                </div>
                <div class = "layui-col-md3 thing-total">
                    <p>
                        <i class = "iconfont">&#xe60c;</i>
                        <span>共治率</span>
                    </p>
                    <div class = "thing-num">
                        <b>45</b>
                        <p class="Up">+25%同比增长</p>
                    </div>
                </div>
            </div>
            <div class = "layui-row thing-trend">
                <div class = "layui-row" style = "height: 15%">
                    <div class = "layui-col-md6 trend-title">
                        <p>事件趋势</p>
                    </div>
<!--                    <div class = "layui-col-md6 trend-tab">-->
<!--                        <ul class = "layui-row trend-Tabtile" id="qushi">-->
<!--                            <li class = "layui-col-md4 active">-->
<!--                                本日-->
<!--                            </li>-->
<!--                            <li class = "layui-col-md4">本周</li>-->
<!--                            <li class = "layui-col-md4">本月</li>-->
<!--                        </ul>-->
<!--                        <div class = "thing-data">-->
<!--                            <input-->
<!--                                    type = "text"-->
<!--                                    class = "layui-input"-->
<!--                                    id = "test1"-->
<!--                                    readonly-->
<!--                                    placeholder = "请选择日期范围"-->
<!--                            />-->
<!--                            <i class = "iconfont">&#xe616;</i>-->
<!--                        </div>-->
<!--                    </div>-->
                </div>
                <div
                        class = "layui-row"
                        style = "height: 80%"
                >
                    <div
                            class = ""
                            id = "total"
                            style = "width: 100%; height: 100%"
                    ></div>
                </div>
            </div>
        </div>
        <div class = "layui-col-md4" style = "width: 32%;margin-left: 1%;">
            <div class = "layui-row  empowerment">
                <div class = "layui-row thing-empowerment">
                    <div class = "layui-col-md6 trend-title">
                        <p>赋能流转</p>
                    </div>
                    <!--                    <div class = "layui-col-md6 trend-tab">-->
                    <!--                        <ul class = "trend-Tabtile layui-row " id = "funeng">-->
                    <!--                            <li class = "layui-col-md4 active">本日</li>-->
                    <!--                            <li class = "layui-col-md4">本周</li>-->
                    <!--                            <li class = "layui-col-md4">本月</li>-->
                    <!--                        </ul>-->
                    <!--                    </div>-->
                </div>
                <div
                    class = "layui-row"
                    style = "height: 85%"
                >
                    <div
                        class = ""
                        id = "purchase"
                        style = "width: 100%; height: 100%"
                    ></div>
                </div>
            </div>

        </div>
    </div>
    <div class = "layui-row testing">
        <div class = "layui-col-md4 testing-ting">
            <div class = "layui-row thing-empowerment">
                <div class = "layui-col-md6 trend-title">
                    <p>社区检测</p>
                </div>
<!--                <div class = "layui-col-md6 trend-tab">-->
<!--                    <ul class = "trend-Tabtile layui-row " id="jiance">-->
<!--                        <li class = "layui-col-md4 active">本日</li>-->
<!--                        <li class = "layui-col-md4">本周</li>-->
<!--                        <li class = "layui-col-md4">本月</li>-->
<!--                    </ul>-->
<!--                </div>-->
            </div>
            <div
                    class = "layui-row "
                    style = "height: 87%"
            >
                <div
                        class = ""
                        id = "testing"
                        style = "width: 100%; height: 100%"
                ></div>
            </div>
        </div>
        <div class = "layui-col-md4 testing-ting">
            <div class = "layui-row thing-empowerment">
                <div class = "layui-col-md4 trend-title">
                    <p>类型统计</p>
                </div>
<!--                <div class = "layui-col-md8 trend-tab">-->
<!--                    <ul class = "trend-Tabtile layui-row" id="tongji">-->
<!--                        <li class = "layui-col-md4 active">本日</li>-->
<!--                        <li class = "layui-col-md4">本周</li>-->
<!--                        <li class = "layui-col-md4">本月</li>-->
<!--                    </ul>-->
<!--&lt;!&ndash;                    <form class = "layui-form">&ndash;&gt;-->
<!--                        <select name = "" lay-verify = "">-->
<!--                            <option value = "">请选择社区</option>-->
<!--                        </select>-->
<!--&lt;!&ndash;                    </form>&ndash;&gt;-->
<!--                </div>-->
            </div>
            <div
                    class = "layui-row"
                    style = "height: 85%"
            >
                <div
                        class = ""
                        id = "Statistics"
                        style = "width: 100%; height: 100%"
                ></div>
            </div>
        </div>
        <div class = "layui-col-md4 testing-ting">
            <div class = "layui-row thing-empowerment">
                <div class = "layui-col-md6 trend-title">
                    <p>事件分析</p>
                </div>
<!--                <div class = "layui-col-md6 trend-tab">-->
<!--                    <ul class = "trend-Tabtile layui-row " id="fenxi">-->
<!--                        <li class = "layui-col-md4 active">本日</li>-->
<!--                        <li class = "layui-col-md4">本周</li>-->
<!--                        <li class = "layui-col-md4">本月</li>-->
<!--                    </ul>-->
<!--                </div>-->
            </div>
            <div
                    class = "layui-row"
                    style = "height: 85%"
            >
                <div
                        class = ""
                        id = "analysis"
                        style = "width: 100%; height: 100%"
                ></div>
            </div>
        </div>
    </div>
</div>
</div>
</body>

<script th:src = "@{/layui/layui.js}"></script>
<script th:src = "@{/js/echarts.min.js}"></script>
<!--tab切换数据-->
<script>
    $('#dataTab li').on('click', function () {
        // 删除li的active
        $('#dataTab li').removeClass('active');
        // 给当前li添加active
        $(this).addClass('active');
        // 判断当前那个li被点击切换echarts数据
        if ($('#dataTab li:eq(0)').is('.active')) {
            qushi([70, 89, 34, 70, 124, 230, 40, 180, 70, 50, 90, 120, 170,], [40, 38, 80, 94, 141, 87, 104, 120, 48, 60, 100, 140, 160,]);
            funeng([54, 29, 17], [262, 145, 86]);
            jiance([70, 89, 34, 70, 124, 230, 40, 180, 70, 50, 90, 120, 170,], [40, 38, 80, 94, 141, 87, 104, 120, 48, 60, 100, 140, 160,]);
            tongji([35, 12, 13, 16, 24])
            fenxi([11, 22, 41, 53, 84, 100, 123, 187])
        } else if ($('#dataTab li:eq(1)').is('.active')) {
            qushi([50, 48, 40, 34, 101, 57, 84, 150, 88, 98, 79, 120, 80], [40, 38, 80, 94, 141, 87, 104, 120, 78, 88, 69, 100, 120])
            funeng([72, 56, 30,], [206, 74, 53,])
            jiance([80, 50, 90, 100, 40, 60, 100, 80, 70, 90, 100, 120, 130,], [70, 90, 50, 70, 60, 20, 32, 71, 34, 90, 30, 80, 40])
            tongji([45, 22, 33, 46, 30])
            fenxi([45, 22, 33, 46, 54, 70, 180, 190])
        } else if ($('#dataTab li:eq(2)').is('.active')) {
            qushi([70, 28, 60, 64, 131, 97, 74, 90, 108, 58, 49, 80, 100], [70, 89, 34, 70, 124, 230, 40, 180, 70, 50, 90, 120, 170,])
            funeng([94, 29, 17], [222, 65, 50,])
            jiance([60, 50, 80, 70, 100, 90, 120, 80, 100, 110, 90, 130, 150], [70, 89, 34, 70, 124, 230, 40, 180, 70, 50, 90, 120, 170,])
            tongji([55, 42, 53, 76, 50])
            fenxi([55, 42, 53, 66, 74, 130, 150, 200])
        }
    })

    layui.use(["laydate", "element", "form"], function () {
        var laydate = layui.laydate;
        var element = layui.element;
        var form = layui.form;
        $('#strongBase').on('click', function () {
            layer.msg('暂未开放')
        });
        $('#zongzhi').on('click', function () {
            layer.msg('暂未开放')
        });
        $('#zhian').on('click', function () {
            layer.msg('暂未开放')
        })
        $('#quyu').on('click', function () {
            layer.msg('暂未开放')
        })
        $('#sheqing').on('click', function () {
            layer.msg('暂未开放')
        })
        $('#minsheng').on('click', function () {
            layer.msg('暂未开放')
        })
        $('#zhihui').on('click', function () {
            layer.msg('暂未开放')
        })
        $('#pingtai').on('click', function () {
            layer.msg('暂未开放')
        })
        $("#shugan").on('click',function () {
            layer.msg('暂未开放');
        })
        //执行一个laydate实例
        laydate.render({
            elem: "#test1", //指定元素
            range: true, //范围选择
        });
    });

    qushi([70, 89, 34, 70, 124, 230, 40, 180, 70, 50, 90, 120, 170,], [40, 38, 80, 94, 141, 87, 104, 120, 48, 60, 100, 140, 160,]);
    funeng([54, 29, 17], [262, 145, 86]);
    jiance([70, 89, 34, 70, 124, 230, 40, 180, 70, 50, 90, 120, 170,], [40, 38, 80, 94, 141, 87, 104, 120, 48, 60, 100, 140, 160,]);
    tongji([35, 12, 13, 16, 24]);
    fenxi([11, 22, 41, 53, 84, 100, 123, 187])
    // 事件趋势echarts
    function qushi(data1,data2) {
        var total = echarts.init(document.getElementById("total"));
        var Toption = {
            tooltip: {
                trigger: "axis",
                axisPointer: {
                    type: "cross",
                },
            },
            legend: {
                top: "bottom",
                itemWidth: 15,
                itemHeight: 15,
                textStyle: {
                    color: '#555'
                }
            },
            grid: {
                left: "5%",
                top: "5%",
                right: "5%",
                bottom: "10%",
                containLabel: true,
            },
            xAxis: {
                type: "category",
                axisLine: {
                    lineStyle: {
                        color: "#888",
                    },
                },
                axisTick: {
                    show: false,
                },
                axisLabel: {
                    interval: 0,
                    rotate: 30,
                    textStyle: {
                        color: "#333",
                    },
                },
                data: [
                    "00:00-02:00",
                    "02:00-04:00",
                    "04:00-06:00",
                    "08:00-10:00",
                    "10:00-12:00",
                    "14:00-16:00",
                    "16:00-18:00",
                    "20:00-20:00",
                    "22:00-00:00",
                ],
            },
            yAxis: {
                type: "value",
                axisLine: {
                    show: false,
                },
                axisTick: {
                    show: false,
                },
                splitLine: {
                    show: true,
                    lineStyle: {
                        type: "dashed",
                    },
                },
                axisLabel: {
                    textStyle: {
                        color: "#333",
                    },
                },
                // boundaryGap: [0, 0.01],
            },
            color: ["#0070CC", "#2ACA96"],
            series: [
                {
                    name: "店铺",
                    type: "bar",
                    data: data1,
                    barGap: 0,
                    barWidth: 15,
                },
                {
                    name: "街道",
                    type: "bar",
                    data: data2,
                    barGap: 0,
                    barWidth: 15,
                },
            ],
        };
        total.setOption(Toption);
    }
    
    // 赋能流转echarts
    function funeng(data1,data2) {
        var purchase = echarts.init(document.getElementById("purchase"));
        var Poption = {
            tooltip: {
                trigger: "item",
                formatter: function (params) {
                    // console.log(params);
                    var str =params.marker+params.name+'：'+params.value+'%';
                    return str;
                },
            },
            grid: {
                top: 5,
                left: 5,
                right: 5,
                bottom: 5,
            },
            color: ["#FEC400", "#0070CC", "#2ACA96",],
            series: [
                {
                    name: "赋能流转",
                    type: "funnel",
                    left: "10%",
                    top: '5%',
                    //x2: 80,
                    bottom: '10%',
                    width: "80%",
                    // height: {totalHeight} - y - y2,
                    min: 10,
                    max: 100,
                    minSize: "20%",
                    maxSize: "100%",
                    sort: "descending",
                    gap: 0,
                    label: {
                        normal: {
                            show: true,
                            position: "inside",
                            formatter: "{c}%",
                        },
                    },
                    labelLine: {
                        length: 10,
                        lineStyle: {
                            width: 1,
                            type: "solid",
                        },
                    },
                    itemStyle: {
                        borderColor: "#fff",
                        borderWidth: 0,
                    },
                    data: [
                        {
                            value: data1[0],
                            name: "研判总数"
                        },
                        {
                            value: data1[1],
                            name: "正在处理"
                        },
                        {
                            value: data1[2],
                            name: "完成总数"
                        },
                    ],
                },
                {
                    name: "赋能流转",
                    type: "funnel",
                    left: "10%",
                    top: '5%',
                    //x2: 80,
                    bottom: '10%',
                    width: "80%",
                    min: 10,
                    max: 100,
                    minSize: "20%",
                    maxSize: "100%",
                    sort: "descending",
                    gap: 0,
                    label: {
                        normal: {
                            show: true,
                            // itemStyle:{
                            color: "#333",
                            // }
                        },
                    },
                    labelLine: {
                        length: 10,
                        lineStyle: {
                            width: 1,
                            type: "solid",
                            color: "#888",
                        },
                    },
                    itemStyle: {
                        borderColor: "#fff",
                        borderWidth: 0,
                    },
                    data: [
                        {
                            value: data1[0],
                            name: "研判总数 " + data2[0] + ""
                        },
                        {
                            value: data1[1],
                            name: "正在处理 " + data2[1] + ""
                        },
                        {
                            value: data1[2],
                            name: "完成总数 " + data2[2] + ""
                        },
                    ],
                },
            ],
        };
        purchase.setOption(Poption);
    }

    // 社区检测echarts
    function jiance(data1,data2) {
        var testing = echarts.init(document.getElementById("testing"));
        var toption = {
            tooltip: {
                trigger: "axis",
                axisPointer: {
                    // 坐标轴指示器，坐标轴触发有效
                    type: "cross", // 默认为直线，可选为：'line' | 'shadow'
                },
            },
            legend: {
                top: "bottom",
                itemWidth: 15,
                itemHeight: 15,
                textStyle: {
                    color: '#555'
                }
            },
            grid: {
                top: 5,
                left: "3%",
                right: "4%",
                bottom: "8%",
                containLabel: true,
            },
            xAxis: {
                type: "value",
                axisLine: {
                    show: false,
                    lineStyle: {
                        color: "#888",
                    },
                },
                axisTick: {
                    show: false,
                },
                splitLine: {
                    show: true,
                    lineStyle: {
                        type: "dashed",
                    },
                },
            },
            yAxis: {
                type: "category",
                data: ['青山', '大园', '蒋杨', '鹤亭', '研口', '胜联', '相府', '青南村', '青南村', '庆南村', '庆北村', '泉口村', '雅观村'],
                axisLine: {
                    lineStyle: {
                        color: "#333",
                    },
                },
                axisTick: {
                    show: false,
                },
            },
            color: ["#0070CC", "#2ACA96"],
            series: [
                {
                    name: "店铺",
                    type: "bar",
                    stack: "总量",
                    data: data1,
                    barWidth: 15,
                },
                {
                    name: "街道",
                    type: "bar",
                    stack: "总量",
                    data: data2,
                    barWidth: 15,
                },
            ],
        };
        testing.setOption(toption);
    }

    // 类型统计echarts
    function tongji(data) {
        var Statistics = echarts.init(document.getElementById("Statistics"));
        var Soption = {
            tooltip: {
                trigger: "item",
                formatter: function (params) {
                    var result = '';
                    result += params.marker + params.data.name + '：' + params.data.value + '(' + params.percent + '%)';
                    return result
                }
            },
            grid: {
                top: "5%",
                left: 5,
                right: 5,
                bottom: "20%",
                containLabel: true,
            },
            legend: {
                // orient: 'or',
                top: "bottom",
                itemWidth: 15,
                itemHeight: 15,
                textStyle: {
                    color: '#555'
                }
            },
            color: ["#217FCD", "#44CCA0", "#F8C721", "#6E7E9B", "#F98A65"],
            series: [
                {
                    name: "类型统计",
                    type: "pie",
                    radius: ["50%", "70%"],
                    avoidLabelOverlap: false,
                    label: {
                        show: true,
                        position: "outside",
                        formatter: "{d}% {b} ",
                    },

                    labelLine: {
                        show: true,
                    },
                    data: [
                        {
                            value: data[0],
                            name: "出店经营"
                        },
                        {
                            value: data[1],
                            name: "非机动车违停"
                        },
                        {
                            value: data[2],
                            name: "沿街晾晒"
                        },
                        {
                            value: data[3],
                            name: "游商摊贩"
                        },
                        {
                            value: data[4],
                            name: "垃圾堆放"
                        },
                    ],
                },
            ],
        };
        Statistics.setOption(Soption);
    }

    // 事件分析echarts
    function fenxi(data) {
        var analysis = echarts.init(document.getElementById("analysis"));
        var Aoption = {
            tooltip: {
                trigger: "axis",
                axisPointer: {
                    // 坐标轴指示器，坐标轴触发有效
                    type: "shadow", // 默认为直线，可选为：'line' | 'shadow'
                },
                formatter:function (params) {
                    // console.log(params)
                    var str = params[0].marker+params[0].name+params[0].value;
                    return str
                }
            },
            grid: {
                top: "5%",
                left: "5%",
                right: "5%",
                bottom: "3%",
                containLabel: true,
            },
            xAxis: [
                {
                    type: "value",

                    axisTick: {
                        show: false,
                    },
                    axisLine: {
                        show: false,
                    },
                    axisLabel: {
                        show: false,
                    },
                    splitLine: {
                        show: false,
                    },
                },
            ],
            yAxis: [
                {
                    type: "category",
                    axisTick: {
                        show: false,
                    },
                    axisLine: {
                        show: false,
                    },
                    data: [
                        "聚众斗殴",
                        "机动车违停",
                        "人员聚集",
                        "非机动车违停",
                        "沿街晾晒",
                        "游商摊贩",
                        "垃圾堆放",
                        "出店经营",
                    ],
                    axisLabel: {
                        color: '#333'
                    }
                },
            ],

            series: [
                {
                    name: "分析率",
                    type: "bar",
                    barWidth: "60%",
                    stack: 1,
                    data: data,
                    barWidth: 10,
                    label: {
                        show: true,
                        position: "right",
                    },
                    itemStyle: {
                        barBorderRadius: 15,
                        color: function (params) {
                            var colorList = [
                                "#FFEF8E",
                                "#FECD27",
                                "#C4CCE7",
                                "#7484A0",
                                "#A0F4CA",
                                "#4AD2A6",
                                "#97DDFF",
                                "#2785D3",
                            ];
                            return colorList[params.dataIndex];
                        },
                    },
                },
            ],
        };

        analysis.setOption(Aoption);

    }

    setTimeout(() => {
        var total = echarts.init(document.getElementById("total"));
        var purchase = echarts.init(document.getElementById("purchase"));
        var testing = echarts.init(document.getElementById("testing"));
        var Statistics = echarts.init(document.getElementById("Statistics"));
        var analysis = echarts.init(document.getElementById("analysis"));
        window.onresize = function () {
            purchase.resize();
            testing.resize();
            Statistics.resize();
            total.resize();
            analysis.resize();
        };
    }, 500);
</script>

</html>
